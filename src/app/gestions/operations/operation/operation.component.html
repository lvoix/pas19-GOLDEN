<!-- main app container -->
<div class="card m-3">
    <h5 class="card-header">Edit un operation</h5>
    <div class="">
    <div class="float-md-right">
      <button class="btn btn-info" (click)="ActiveEdit()"><i class="fa fa-pencil"></i> Edit {{edit}} </button>
    </div>
    <div class="float-md-right">
      <button class="btn btn-danger" mat-button (click)="openDialog()"><i class="fas fa-file-invoice"></i> Facturer {{edit}} </button>
    </div>
  </div>
    <div class="card-body">
        <ul ngbNav #nav="ngbNav" [(activeId)]="active" class="nav-tabs">
            <li [ngbNavItem]="1">
              <a ngbNavLink>Infos general</a>
              <ng-template ngbNavContent>
      
                  <form [formGroup]="EditOperationForm">

  <!--   ---------------------------------------------------------------------------------------------------------------------------------  -->
                                <div class="form-row">
                                        <div class="form-group col-4">
                                                <label>Status</label>
                                                <select formControlName="status" class="form-control">
                                                    <option value="CREATE">CREATE</option>
                                                    <option value="ACTIVE">ACTIVE</option>
                                                    <option value="ENCOURS">ENCOURS</option>
                                                    <option value="NEGOCIABLE">NEGOCIABLE</option>
                                                    <option value="CONFIRME">CONFIRME</option>
                                                    <option value="ANNULE">ANNULE</option>
                                                    <option value="PREACTIVE">PREACTIVE</option>
                                                </select>
                                                <!-- <div *ngIf="submitted && f.status.errors" class="invalid-feedback">
                                                    <div *ngIf="f.status.errors.required">genre is required</div>
                                                </div> -->
                                            </div>
                                            <div class="form-group col-4">
                                              <label>Type de l'operation</label>
                                              <select  class="form-control" formControlName="operationtype">
                                                <option value="DIRECT">DIRECT</option>
                                                <option value="R1">R1</option>
                                                <option value="INTERMEDAIRE">INTERMEDAIRE</option>                                             </select>
                                            </div>
                                        
                                </div>
                                 <div class="form-row">
                                    
                                              <div class="form-group col-4">
                                                    <label>N Dossier</label>
                                                    <input type="text" disabled formControlName="ndossier" class="form-control" />
                                                 <!--   <div *ngIf="submitted && f.matricule.errors" class="invalid-feedback">
                                                        <div *ngIf="f.matricule.errors.required">matricule is required</div>
                                                    </div>   -->
                                            </div>
                                            
                                              <div class="form-group col-4">
                                                  <label>Client</label>
                                                  <select  class="form-control"  formControlName="beneficiaire">
                                                      <option *ngFor="let be of beneficiares"  value="{{be.id}}">  {{be.name}} </option>
                                                      </select>
                                                  <!-- <div *ngIf="submitted && f.status.errors" class="invalid-feedback">
                                                      <div *ngIf="f.status.errors.required">genre is required</div>
                                                  </div> -->
                                              </div>
                                               
                                                <div class="form-group col-4">
                                                        <label>Motif client</label>
                                                        <input type="text" formControlName="motifClient"  class="form-control" />
                                                    <!--   <div *ngIf="submitted && f.libelle.errors" class="invalid-feedback">
                                                            <div *ngIf="f.libelle.errors.required">Liblle is required</div>
                                                        </div> -->
                                                    </div>
                                                                
                          </div>

                          <div class="form-row">
                                <div class="form-group col-4">                                
                                        <label for="dateCreation">Date de creation</label>
                                        <div class="input-group">
                                          <input class="form-control" disabled placeholder="yyyy-mm-dd"
                                                 name="dateCreation" value="{{datecreation  | date :'yyyy-MM-dd' }}" ngbDatepicker #dateCreation="ngbDatepicker">               
                                        </div>
                                    </div>
                        
                       <div class="form-group col-4">                                
                                  <label for="datedepart">Date depart</label>
                                  <div class="input-group">
                                    <input class="form-control"
                                           name="datedepart"
                                           type="date" formControlName="datedepart" 
                                            ngbDatepicker #datedepart="ngbDatepicker">
                                           <div class="input-group-prepend">
                                                  <a class="btn btn-outline-secondary calendar" (click) ="datedepart.toggle()"><i class="fa fa-calendar"></i></a>
                                            </div>
                                  </div>
                                            </div>
                                            <div class="form-group col-4">                                
                                                <label for="datedepart">Date de fin</label>
                                                <div class="input-group">
                                                  <input class="form-control" placeholder="yyyy-MM-dd"
                                                        name="dateFin" 
                                                        type="date"  formControlName ="dateFin"
                                                         ngbDatepicker #dateFin="ngbDatepicker">
                                                        <div class="input-group-prepend">
                                                                <a class="btn btn-outline-secondary calendar" (click) ="dateFin.toggle()"><i class="fa fa-calendar"></i></a>
                                                        </div>
                                                </div>
                                        </div> 

                          </div>
                         <div class="form-row">
                                     <div class="form-group col-4">
                                      <label for="tracteurs">Tracteur</label>
                                      <select  class="form-control" formControlName="tracteurs" >
                                              <option *ngFor="let te of tracteur"  value="{{te.id}}"> {{te.matricule}}</option>
              
                                      </select>
                                          
                                         <!--  <div *ngIf="submitted && f.model.errors" class="invalid-feedback">
                                              <div *ngIf="f.model.errors.required">model is required</div>
                                          </div> -->
                                      </div>
                                     
                                          <div class="form-group col-4">
                                            <label>Type tracteur</label>
                                            <input type="text" formControlName="genret" class="form-control"/>
                                          </div>
                                      
                                        <div class="form-group col-4">
                                            <label>Ref chargement</label>
                                            <input type="text" formControlName="refChargement" class="form-control" />
                                            
                                        </div>
                                               

                          </div>
                           <div class="form-row">
                              <div class="form-group col-4">                           
                                  <label for="remorques">Remorque</label>
                                  <select  class="form-control"  formControlName="remorques">
                                <option *ngFor="let re of remorque" value="{{re.id}}"> {{re.matricule}}</option>
                                </select>
                                  
                             <!--  <div *ngIf="submitted && f.genre.errors" class="invalid-feedback">
                                  <div *ngIf="f.genre.errors.required">genre is required</div>
                              </div> -->
                               
                              </div> 
                              <div class="form-group col-4">
                                <label>Type remorque</label>
                                <input type="text" formControlName="genrer" class="form-control"/>
                              </div>
                           
                              <div class="form-group col-4">
                                <label>Type de marchandises</label>
                                <input type="text" formControlName="typeMarchandises"  class="form-control" />
                              <!--   <div *ngIf="submitted && f.libelle.errors" class="invalid-feedback">
                                    <div *ngIf="f.libelle.errors.required">Liblle is required</div>
                                </div> -->
                            </div>
               
                          </div> 
                      <div class="card m-3">
                              <h5 class="card-header text-center font-weight-bold text-uppercase"> Conducteurs & Dotations</h5>

                          <div class="card-body">
                              <div class="form-row">
                                    <div class="form-group col-6">
                                       
                                            <div class="">
                                                <label for="Client"> Conducteur 1 </label>
                                                <select  class="form-control"  formControlName="conducteurs1" id="conducteurs1" name="conducteurs1"  >
                                              <option *ngFor="let cond of conducteur"  value="{{cond.id}}"> {{cond.lastName}} {{cond.firstName}} </option>
                                              </select>
                                            </div>
                                   
                              </div>
                               
                                  <div class="form-group col-6">
                                       
                                                <div class="">
                                                    <label for="Client"> Conducteur 2 </label>
                                                    <select  class="form-control" formControlName="conducteurs2" id="conducteurs2" name="conducteurs2" >
                                                  <option *ngFor="let condu of conducteur" value="{{condu.id}}"> {{condu.lastName}} {{condu.firstName}} </option>
                                                  </select>
                                                </div>
                                       
                                  </div>
                                </div>
                                  <div class="form-row">

                              <div class="form-group col-6">
                                    <label>Dotation DH</label>
                                    <input type="text" formControlName="dotationDH" class="form-control"/>
                                 <!--   <div *ngIf="submitted && f.matricule.errors" class="invalid-feedback">
                                        <div *ngIf="f.matricule.errors.required">matricule is required</div>
                                    </div>   -->
                            </div>
                            <div class="form-group col-6">
                                <label>Dotation EURO</label>
                                <input type="text" formControlName="dotationEuro" class="form-control" />
                            <!--     <div *ngIf="submitted && f.vehiculeType.errors" class="invalid-feedback">
                                    <div *ngIf="f.vehiculeType.errors.required"> type is required</div>
                                </div> -->
                            </div>
                          
                        </div>

                        </div>
                      </div>
                    </form>              
                            <!-- Editable table -->
                            <div class="card m-3">
                                    <h5 class="card-header text-center font-weight-bold text-uppercase"> Les adresses chargement & livraison</h5>
                                    <div class="card-body">
                                    <div id="table" class="table-editable">
                                        <span class="table-add float-right mb-3 mr-2">
                                        <a class="text-success" (click)="add()">
                                                <i class="fa fa-plus" aria-hidden="true"></i>
                                        </a>
                                        </span>
                                        <table class="table table-bordered table-responsive-md table-striped text-center" >
                                        <tr>
                                            <th class="text-center">ID</th>
                                            <th class="text-center">Nom client</th>
                                            <th class="text-center">Ville</th>
                                            <th class="text-center">Country</th>
                                            <th class="text-center">Zip</th>
                                            <th class="text-center">Street1</th>
                                            <th class="text-center">Type station</th>
                                            <th class="text-center">Order</th>
                                            <th class="text-center">Actions</th>
                                        </tr>
                                        <tr *ngFor="let adr of stations; let i = index">
                                             <td>
                                                <span *ngIf="!adr.editable">{{adr.id}}</span>
                                                <input type="text" class="form-control" [(ngModel)]="adr.id" name="id{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.nomClient}}</span>
                                                  <input type="text" class="form-control" [(ngModel)]="adr.nomClient" name="nomClient{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.city}}</span>
                                                  <input type="text" class="form-control" [(ngModel)]="adr.city" name="city{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.country}}</span>
                                                  <input type="text" class="form-control" [(ngModel)]="adr.country"  name="country{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.zipCode}}</span>
                                                  <input type="text" class="form-control" [(ngModel)]="adr.zipCode" name="zipCode{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.street1}}</span>
                                                  <input type="text" class="form-control" [(ngModel)]="adr.street1" name="street1{{i + 1}}" *ngIf="adr.editable"/>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.typeStation}}</span>
                                                  <select [(ngModel)]="adr.typeStation" name="typeStation{{i + 1}}" *ngIf="adr.editable">
                                                      <option  value="C"> C </option>
                                                      <option  value="L"> L </option>
                                                   </select>
                                              </td>
                                              <td>
                                                  <span *ngIf="!adr.editable">{{adr.ordere}}</span>
                                                  <input type="text" class="form-control" name="ordere{{i + 1}}" [(ngModel)]="adr.ordere" *ngIf="adr.editable"/>
                                              </td>
                                            <td>
                                            <span class="table-remove">
                                                <button [disabled]= !isDisable type="button" color="danger" rounded="true" size="sm" class="my-0" (click)="editDomain(adr)">Edit</button>
                                                <button [disabled]= !isDisable type="button" color="danger" rounded="true" size="sm" class="my-0" (click)="remove(i)">Remove</button>
                                                <button type="button"  rounded="true" size="sm" class="my-0" (click)="affichetable(i)">affiche</button>

                                            </span>
                                            </td>
                                        </tr>
                                        </table>
                                    </div>
                                    </div>
                                </div>
                                <!-- Editable table -->

                          <div class="text-center">
                              <button type="submit" [disabled]="!EditOperationForm.valid && !isDisable" class="btn btn-primary mr-1 col-4" (click)="onSubmit()">Edit save</button>
                              <button  [disabled]= !isDisable class="btn btn-secondary col-4"  (click)="resetForm()">Reset</button>
                          </div>


              </ng-template>

            </li>
            <li [ngbNavItem]="2">
              <a ngbNavLink>Documents</a>
              <ng-template ngbNavContent>
            <!--     <p>Partie 2.</p> -->
                <app-addfile [operation]="idoperation"></app-addfile>
              </ng-template>
            </li>
            <li [ngbNavItem]="3">
              <a ngbNavLink>Complementaire</a>
              <ng-template ngbNavContent>
                <p> Partie 3.</p>
              </ng-template>
            </li>
          </ul>
          
          <div [ngbNavOutlet]="nav" class="mt-2"></div>
          
          <pre>Active: {{ active }}</pre>
    
    </div>
</div>
